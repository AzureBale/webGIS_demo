<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <title>多边形检索</title>
    <link rel="stylesheet" href="https://cache.amap.com/lbs/static/main1119.css"/>
    <style type="text/css">
        #container{
          width: 100%;
          height: 100%;
        }
        #result {
            margin: 0;
            padding: 0;
            z-index: 999;
            position: absolute;
            background-color: white;
            max-height: 100%;
            overflow-y: auto;
            top: 0;
            right: 0;
            width: 280px;
        }
    </style>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=f4e095be087630133e20de9ce76e2fa8"></script>
    <script type="text/javascript" src="https://cache.amap.com/lbs/static/addToolbar.js"></script>
</head>
<body>

<button id="bt1" class="btn" onclick="buttonClick();" style="position: fixed; left: 20%;z-index: 10; margin-right:1rem;">查询餐饮点</button>
<button id="bt2" class="btn2" onclick="buttonClick2();" style="position: fixed; left: 10%;z-index: 10; margin-right:1rem;">查询教室</button>
<button id="bt2" class="btn3" onclick="buttonClick3();" style="position: fixed; left: 15%;z-index: 10; margin-right:1rem;">查询超市</button>
<div id="container"></div>
<div id="result"></div>
<script type="text/javascript">

    var map = new AMap.Map('container', {
        zoom:15.4,//缩放级别，数值越大则比例尺越大
        center: [117.1445210000, 34.2151070000],//中心点坐标 中国矿业大学南湖校区
        viewMode:'3D'//使用3D视图
        ,resizeEnable: true
    });



    function searchThis(ex) {

    AMap.service(["AMap.PlaceSearch"], function() {
        var placeSearch = new AMap.PlaceSearch({ //构造地点查询类
            pageSize: 31, // 单页显示结果条数
            pageIndex: 1, // 页码
            city: "0516", // 兴趣点城市
            citylimit: true,  //是否强制限制在设置的城市内搜索
            map: map, // 展现结果的地图实例
            panel: "result", // 结果列表将在此容器中进行展示。
            autoFitView: true // 是否自动调整地图视野使绘制的 Marker点都处于视 口的可见范围
        });
        //多边形查
        var polygonArr = [//多边形覆盖物节点坐标数组
            [117.1379080000,34.2123060000],
            [117.1370440000,34.2125750000],
            [117.1362810000,34.2131020000],
            [117.1438210000,34.2218550000],
            [117.1499570000,34.2203820000],
            [117.1566520000,34.2189150000],
            [117.1443780000,34.2060440000],
            [117.1360360000,34.2092230000]

        ];
        var polygon = new AMap.Polygon({
            path: polygonArr,//设置多边形边界路径
            strokeColor: "#FF33FF", //线颜色
            strokeOpacity: 0.2, //线透明度
            strokeWeight: 3,    //线宽
            fillColor: "#1791fc", //填充色
            fillOpacity: 0.35//填充透明度
        });
        if (ex==='餐厅') {
          placeSearch.searchInBounds("餐厅", polygon);
        }
        if(ex==='教室'){
          placeSearch.searchInBounds("博学|公共教学", polygon);          
        }
        if(ex==='超市'){
          placeSearch.searchInBounds("超市|商店", polygon);          
        }

        
    });
    }


    var cenima = '餐厅';
    var classroom = '教室';
    var shop = '超市';
    var button1 = document.getElementById('bt1'); 
    var button2 = document.getElementById('bt2');
    var button3 = document.getElementById('bt3');  
    //定义button2为bt2的DOM元素
    function buttonClick(){  
    var listener1 = AMap.event.addDomListener(button1, 'click',searchThis(cenima));
        } 
    function buttonClick2(){  
    var listener2 = AMap.event.addDomListener(button1, 'click',searchThis(classroom));
        }
    function buttonClick3(){  
    var listener3 = AMap.event.addDomListener(button1, 'click',searchThis(shop));
        }      
   //var listener2 = AMap.event.addDomListener(button1, 'click',searchThis());
    //给DOM元素：button2，添加“点击”事件监听器，执行search函数的操作

</script>
</body>
</html>